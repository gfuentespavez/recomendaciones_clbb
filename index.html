<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Recomiendo Concepci√≥n - City Lab Biob√≠o</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Mapbox -->
  <link href="https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.css" rel="stylesheet" />
  <script src="https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.js"></script>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Custom Styles -->
  <link rel="stylesheet" href="assets/styles/styles.css" />

  <!-- Google Maps Places -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCwNsIode9P9Aa1ZPhkMtN9n1DGVwSsDZg&libraries=places"></script>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&display=swap" rel="stylesheet">

</head>

<body>
<!-- Map Container -->
<div id="map"></div>

<!-- FAB (Bot√≥n Men√∫) -->
<div id="main-fab-menu" style="position: fixed; top: 1rem; left: 1rem; z-index: 2100;">
  <button class="btn btn-light shadow d-flex align-items-center gap-2 rounded-pill px-3 py-2 menu-btn" type="button" data-bs-toggle="offcanvas" data-bs-target="#menuOffcanvas" title="Men√∫">
    <span class="menu-icon">
      <img src="assets/svg/menu.svg" alt="Men√∫" style="width: 1rem; height: 1rem;" />
    </span>
    <span class="fw-semibold">Men√∫</span>
  </button>
</div>
<!-- Offcanvas fullscreen -->
<div class="offcanvas offcanvas-start offcanvas-fullscreen" tabindex="-1" id="menuOffcanvas" aria-labelledby="menuOffcanvasLabel">

  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="menuOffcanvasLabel">
      <img src="assets/png/clbb.png" alt="Logo" style="height: 60px;" />
    </h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Cerrar" style="filter: invert(1);"></button>
  </div>

  <div class="offcanvas-body d-flex flex-column gap-3">
    <button class="btn btn-warning w-100" id="openModalBtn">Agregar lugar</button>

    <h6 class="text-white mb-2">¬øQu√© te gustar√≠a ver?</h6>
    <div id="category-buttons" class="d-flex flex-wrap gap-2">
      <button class="btn tag-btn category-button" data-category="Comida">Comida</button>
      <button class="btn tag-btn category-button" data-category="Bar">Bar</button>
      <button class="btn tag-btn category-button" data-category="Cafeter√≠as">Cafeter√≠a</button>
      <button class="btn tag-btn category-button" data-category="Cultura">Cultura</button>
      <button class="btn tag-btn category-button" data-category="Tiendas">Tienda local</button>
      <button class="btn tag-btn category-button" data-category="Panoramas">Panoramas</button>
      <button class="btn tag-btn category-button" data-category="M√∫sica">M√∫sica en vivo</button>
      <button class="btn tag-btn category-button" data-category="Mirador">Mirador</button>
      <button class="btn tag-btn category-button" data-category="Datos">Dato oculto</button>
    </div>

    <div class="mt-4">
      <h6 class="text-white mb-2">¬øEn qu√© comuna?</h6>
      <div id="comuna-buttons" class="d-flex flex-wrap gap-2">
        <button class="btn tag-btn comuna-button" data-comuna="Tom√©">Tom√©</button>
        <button class="btn tag-btn comuna-button" data-comuna="Penco">Penco</button>
        <button class="btn tag-btn comuna-button" data-comuna="Talcahuano">Talcahuano</button>
        <button class="btn tag-btn comuna-button" data-comuna="Hualp√©n">Hualp√©n</button>
        <button class="btn tag-btn comuna-button" data-comuna="Concepci√≥n">Concepci√≥n</button>
        <button class="btn tag-btn comuna-button" data-comuna="Chiguayante">Chiguayante</button>
        <button class="btn tag-btn comuna-button" data-comuna="Hualqui">Hualqui</button>
        <button class="btn tag-btn comuna-button" data-comuna="Santa Juana">Santa Juana</button>
        <button class="btn tag-btn comuna-button" data-comuna="San Pedro de la Paz">San Pedro</button>
        <button class="btn tag-btn comuna-button" data-comuna="Coronel">Coronel</button>
        <button class="btn tag-btn comuna-button" data-comuna="Lota">Lota</button>
      </div>
    </div>
    <button id="resetFiltersBtn" class="btn btn-secondary w-100 mb-3">Resetear filtros</button>
  </div>
</div>

<!-- Modal para agregar lugar -->
<div class="modal fade fullscreen" id="submitModal" tabindex="-1" aria-labelledby="submitModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <form id="submitForm" class="modal-content" novalidate>
      <div class="modal-header">
        <h5 class="modal-title" id="submitModalLabel">Cu√©ntanos, ¬øcu√°l es tu lugar favorito en Conce?</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label for="lugar" class="form-label">Recomiendo...</label>
          <input type="text" class="form-control" id="lugar" name="lugar" required placeholder="Escribe el nombre del lugar">
        </div>
        <div class="mb-3">
          <label for="comuna" class="form-label">Comuna</label>
          <select class="form-select" id="comuna" name="comuna" required>
            <option value="" disabled selected>Selecciona una comuna</option>
            <option value="Concepci√≥n">Concepci√≥n</option>
            <option value="Talcahuano">Talcahuano</option>
            <option value="Chiguayante">Chiguayante</option>
            <option value="Hualp√©n">Hualp√©n</option>
            <option value="San Pedro de la Paz">San Pedro de la Paz</option>
            <option value="Coronel">Coronel</option>
            <option value="Penco">Penco</option>
            <option value="Tom√©">Tom√©</option>
            <option value="Santa Juana">Santa Juana</option>
            <option value="Lota">Lota</option>
          </select>
        </div>
        <div class="mb-3">
          <label for="categoria" class="form-label">Categor√≠a</label>
          <select class="form-select" id="categoria" name="categoria" required>
            <option value="" disabled selected>Selecciona una categor√≠a</option>
            <option value="Comida">Comida</option>
            <option value="Bar">Bar</option>
            <option value="Cafeter√≠a">Cafeter√≠a</option>
            <option value="Cultura">Cultura</option>
            <option value="Tiendas">Tienda local</option>
            <option value="Panoramas">Panoramas</option>
            <option value="M√∫sica">M√∫sica en vivo</option>
            <option value="Mirador">Mirador</option>
            <option value="Dato">Dato oculto</option>
          </select>
        </div>
        <input type="hidden" id="latitude" name="lat">
        <input type="hidden" id="longitude" name="lon">
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-success w-100">Enviar</button>
      </div>
    </form>
  </div>
</div>

<!-- Fullscreen Info Modal -->
<div class="modal fade fullscreen" id="infoModal" tabindex="-1" aria-labelledby="infoModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content info-modal-content">

      <!-- Header -->
      <div class="modal-header info-modal-header">
        <h2 id="modal-titulo" class="modal-title">Nombre del lugar</h2>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>

      <!-- Modal Body -->
      <div class="modal-body info-modal-body">

        <!-- Row 1: Info -->
        <div class="info-row">
          <div class="info-box categoria-box">
            <p><strong></strong> <span id="modal-categoria"></span></p>
          </div>
          <div class="info-box direccion-box">
            <p><strong></strong> <span id="modal-direccion"></span></p>
          </div>
        </div>

        <!-- Row 2: Rating -->
        <div class="info-row">
          <div class="info-box rating-text">
            <p id="modal-rating"></p>
          </div>
          <div class="info-box rating-stars-container">
            <div id="rating-container" class="rating-stars"></div>
            <p class="rating-response mt-2 text-success"></p>
          </div>
        </div>

        <!-- scanner -->
        <div class="scanner-section">
          <p class="scanner-title">¬°Cu√©ntanos lo mejor de este lugar!</p>
          <div class="form-floating">
            <textarea class="form-control" placeholder="Leave a comment here" id="floatingTextarea"></textarea>
            <label for="floatingTextarea">¬øQu√© recomiendas de este lugar?</label>
          </div>
        </div>

        <button id="enviar-rating" class="btn btn-primary mt-3 w-100">Enviar recomendaci√≥n</button>

      </div> <!-- Cierre del modal-body -->

      <!-- Footer -->
      <div class="modal-footer info-modal-footer">
        <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal" style="border: 2px solid #ffcc05 ">Cerrar</button>
      </div>

    </div> <!-- Cierre del modal-content -->
  </div> <!-- Cierre del modal-dialog -->
</div> <!-- Cierre del modal -->


<!-- Toast Notification -->
<div class="toast-container position-fixed end-0 p-3" style="z-index: 9999">
  <div id="successToast" class="toast align-items-center text-bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="d-flex">
      <div class="toast-body">¬°Gracias por tu recomendaci√≥n! üíõ</div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
  </div>
</div>

<!-- Bot√≥n lupa fijo abajo a la derecha -->
<button
        id="searchToggleButton"
        class="btn btn-outline-light rounded-circle d-flex align-items-center justify-content-center"
        style="
    position: fixed;
    bottom: 1.5rem;
    right: 1.5rem;
    width: 56px;
    height: 56px;
    background-color: #000;
    border: none;
    z-index: 2100;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    cursor: pointer;
  "
        type="button"
        aria-label="Abrir b√∫squeda"
>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="white" class="bi bi-search" viewBox="0 0 16 16">
    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
  </svg>
</button>

<!-- Contenedor del textarea fullscreen oculto inicialmente -->
<div id="searchOverlay">
  <textarea
          id="searchTextarea"
          placeholder="Escribe tu b√∫squeda aqu√≠..."></textarea>
</div>

<!-- Main Script -->
<script type="module" src="./js/main.js"></script>
</body>
</html>
